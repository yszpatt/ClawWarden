# 更新日志 (CHANGELOG)

本文档记录了 ClawWarden 项目的主要里程碑和深度技术更新内容。

---

## [2026-02-04] - 核心交互模型重构与 UI/UX 飞跃

今天我们对项目的核心交互模型进行了革命性的重构，从传统的“原始终端输出”模式全面转向“结构化摘要与对话”模式。

### ✨ 核心功能重构 (Core Refactoring)

#### 1. 结构化增量摘要系统 (Incremental Structured Summaries)
- **技术实现**: 废弃了单次覆盖的摘要写入方式，重构了 `json-store.ts` 中的读写逻辑。现在支持在本地 `.clawwarden` 目录下为每个任务维护一个摘要序列，通过追加方式实现进度的历史溯源。
- **前端展示**: 在 `StructuredOutput.tsx` 中引入了层次化的折叠式（Accordion）视图。
    - **自动索引**: 摘要按时间戳和阶段自动分类。
    - **支持 Markdown**: 集成了 `react-markdown` 和 `remark-gfm`，使得任务产出（如计划方案、测试报告）能以专业、美观的文档格式呈现。
    - **交互优化**: 默认展开最新进度，旧进度可手动折叠，大幅降低了用户获取关键信息的视觉负担。

#### 2. “对话即控制”模型 (Conversational Interaction)
- **模型转变**: 弱化甚至移除了独立的命令行输入，将所有交互统一在 `ConversationPanel.tsx`。
- **流式响应**: 深度集成 Claude Agent SDK 的 `query` 和 `startTaskExecution` 接口，支持毫秒级的消息流式推送，提供如同原生 ChatGPT 的流畅体验。
- **状态感知**: 对话列表能够感知任务状态（正在执行、已停止、已完成），并在界面上通过不同的状态指示灯实时反馈。

### 💄 视觉与交互体验升级 (UI/UX Hyper-focus)

#### 1. 全局设计语言进化
- **风格定义**: 确立了“高科技、专业、冷色调”的视觉基调。
- **细节增强**: 
    - 引入了深度的玻璃拟态（Glassmorphism）效果，利用 `backdrop-filter` 实现了极具层次感的半透明面板。
    - 优化了深色主题的对比度，确保在长时间使用下依然保持良好的可读性。
    - 实现了更为灵动的过渡动画，包括任务卡片的拖拽重排和详情面板的滑动切入。

#### 2. 泳道同步逻辑 (Lane Synchronization)
- **语义化映射**: 通过映射 `Lane` 配置，实现了每个阶段的图标、颜色和按钮的一致性。
    - **计划 (Plan)**: 调色板紫色，使用 `Palette` 图标，操作按钮为“生成计划方案”。
    - **开发 (Develop)**: 调色板蓝靛色，使用 `Code2` 图标，操作按钮为“进入自动化开发”。
    - **测试 (Test)**: 调色板青色，使用 `ShieldCheck` 图标，操作按钮为“开始自动化测试”。
    - **合并 (Merge)**: 调色板灰色，使用 `GitMerge` 图标，操作按钮为“合并到主分支”。

### 🗑️ 系统瘦身 (Performance Optimization)

- **移除 Xterm 依赖**: 考虑到开发者并不总是需要查看原始的调试日志，我们移除了庞大的 `xterm` 库及相关的 `node-pty` 后端组件。
- **内存优化**: `ConnectionManager.ts` 不再在内存中缓存海量的原始终端字符流，转而仅处理高价值的消息和状态包，显著降低了前端在处理长时任务时的内存占用。

---

## [2026-02-03] - 灵活性与项目管理增强

### 📂 项目管理
- **动态导入路径**: 实现了 `FolderPicker` 组件，支持用户从本地文件系统任意位置导入现有项目，而不局限于固定目录。
- **项目持久化**: 重构了 `global.json` 的存储结构，支持对项目列表进行实时编辑和远程删除同步。

---

## [2026-02-02] - 品牌升级与架构奠基

### 🦀 品牌重塑
- **ClawWarden**: 项目正式更名，"Claw" 代表 Claude Code，“Warden” 代表监控者/守卫，寓意为智能化的开发助手提供可视化的管控面板。

### 🧱 架构设计
- **Worktree 隔离机制**: 确立了每个任务独立 Git Worktree 的运行模式，解决了 Claude Code 在并发执行任务时可能产生的文件锁和环境污染问题。
- **Monorepo 结构**: 完成了 `web`、`agent`、`shared` 三个包的工程化搭建，实现了类型安全的全栈共享。

---

## [2026-01-30 至 2026-02-01] - 从 0 到 1 的突破

- **WebSocket 通信层**: 搭建了全双工连接，实现了 Agent 状态和消息的实时分发。
- **基础看板**: 实现了基于 `@dnd-kit` 的看板拖拽交互。
- **SDK 对接**: 完成了与 Anthropic Claude Agent SDK 的初步握手和会话保持。
